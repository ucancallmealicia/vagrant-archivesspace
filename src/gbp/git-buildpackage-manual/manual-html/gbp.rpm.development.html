<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Development flow</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="Building Packages with git-buildpackage suite"
HREF="index.html"><LINK
REL="UP"
TITLE="Building RPM Packages with git-buildpackage-rpm"
HREF="gbp-rpm.html"><LINK
REL="PREVIOUS"
TITLE="Introduction"
HREF="gbp.rpm.intro.html"><LINK
REL="NEXT"
TITLE="Building RPM packages from the Git repository"
HREF="gbp.rpm.building.html"><STYLE
TYPE="text/css"
>.synopsis, .classsynopsis {
    background: #eeeeee;
    border: solid 1px #aaaaaa;
    padding: 0.5em;
}
.programlisting {
    background: #eeeeff;
    border: solid 1px #aaaaff;
    padding: 0.5em;
}
.variablelist {
    padding: 4px;
    margin-left: 3em;
}
.navigation {
    background: #ffeeee;
    border: solid 1px #ffaaaa;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
}
.navigation a {
    color: #770000;
}
.navigation a:visited {
    color: #550000;
}
.navigation .title {
    font-size: 200%;
}</STYLE
></HEAD
><BODY
CLASS="CHAPTER"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><TABLE
WIDTH="100%"
CLASS="navigation"
SUMMARY="Navigation header"
CELLPADDING="2"
CELLSPACING="2"
><TR
VALIGN="middle"
><TD
><A
ACCESSKEY="p"
HREF="gbp.rpm.intro.html"
><IMG
SRC="left.png"
WIDTH="24"
HEIGHT="24"
BORDER="0"
ALT="Prev"></A
></TD
><TD
><A
ACCESSKEY="u"
HREF="gbp-rpm.html"
><IMG
SRC="up.png"
WIDTH="24"
HEIGHT="24"
BORDER="0"
ALT="Up"></A
></TD
><TD
><A
ACCESSKEY="h"
HREF="index.html"
><IMG
SRC="home.png"
WIDTH="24"
HEIGHT="24"
BORDER="0"
ALT="Home"></A
></TD
><TH
WIDTH="100%"
align="center"
>Building Packages with git-buildpackage suite: Version: 0.0</TH
><TD
><A
ACCESSKEY="n"
HREF="gbp.rpm.building.html"
><IMG
SRC="right.png"
WIDTH="24"
HEIGHT="24"
BORDER="0"
ALT="Next"></A
></TD
></TR
></TABLE
><DIV
CLASS="CHAPTER"
><H1
><A
NAME="GBP.RPM.DEVELOPMENT"
></A
>Development flow</H1
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
><A
HREF="gbp.rpm.development.html#GBP.RPM.DEVELOPMENT.MODELS"
>Development models</A
></DT
><DT
><A
HREF="gbp.rpm.development.html#GBP.RPM.DEVELOPMENT.SCRATCH"
>Starting from scratch with a non-native package</A
></DT
><DT
><A
HREF="gbp.rpm.development.html#GBP.RPM.DEVELOPMENT.CONVERT"
>Converting an existing git repository of a non-native package</A
></DT
></DL
></DIV
><BR
CLEAR="all"><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="GBP.RPM.DEVELOPMENT.MODELS"
>Development models</A
></H1
><P
>        The <B
CLASS="COMMAND"
>gbp buildpackage-rpm</B
> toolset basically supports three different
        models of package maintenance.
        </P
><BR
CLEAR="all"><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="GBP.RPM.DEVELOPMENT.MODELS.NATIVE"
>Native package</A
></H2
><P
>            This means that you are the upstream, there is no separate
            upstream with which you have to sync. Basically, only
            <CODE
CLASS="OPTION"
>packaging-branch</CODE
> is used - it contains both the source
            code and packaging files. No patches should be present as all
            changes can be directly committed to upstream (which is you).
            When building, <B
CLASS="COMMAND"
>gbp buildpackage-rpm</B
> will create the source
            tarball and copy it and the packaging to the build directory.
            </P
></DIV
><BR
CLEAR="all"><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="GBP.RPM.DEVELOPMENT.MODELS.NONNATIVE1"
>Upstream package, alternative 1: packaging and sources in
                   the same branch</A
></H2
><P
>            This represents somewhat Debian-style package maintenance.
            All changes (packaging and source code) are done to the same
            branch, i.e., the <CODE
CLASS="OPTION"
>packaging-branch</CODE
>, based on the
            <CODE
CLASS="OPTION"
>upstream-branch</CODE
>. When package is built,
            <B
CLASS="COMMAND"
>gbp buildpackage-rpm</B
> can automatically generate patches from
            upstream version to packaging branch head (one patch per commit).
            and modify the spec file accordingly.
            </P
></DIV
><BR
CLEAR="all"><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="GBP.RPM.DEVELOPMENT.MODELS.NONNATIVE2"
>Upstream package, alternative 2: packaging and sources in
                   separate branches</A
></H2
><P
>            In this model packaging files (spec and patches) are held in
            <CODE
CLASS="OPTION"
>packaging-branch</CODE
> and upstream sources in
            <CODE
CLASS="OPTION"
>upstream-branch</CODE
>.
            Your code development is done on the <CODE
CLASS="OPTION"
>patch-queue-branch</CODE
>,
            based on the <CODE
CLASS="OPTION"
>upstream-branch</CODE
>, which only contains source
            code but no packaging files. When building the package,
            <B
CLASS="COMMAND"
>gbp pq-rpm</B
> tool is used to export patches from the patch queue
            branch to the packaging branch and edit the spec file accordingly.
            Finally, <B
CLASS="COMMAND"
>gbp buildpackage-rpm</B
> will create the upstream source
            tarball and export it and the packaging files to the build
            directory, and, build the RPM package.
            </P
></DIV
></DIV
><BR
CLEAR="all"><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="GBP.RPM.DEVELOPMENT.SCRATCH"
>Starting from scratch with a non-native package</A
></H1
><P
>        In this case, you most probably want to package software not yet
        found in your distro. First, create an empty repository:
        <PRE
CLASS="SCREEN"
>    $ <B
CLASS="COMMAND"
>mkdir</B
> mypackage
    $ <B
CLASS="COMMAND"
>cd</B
> mypackage
    $ <B
CLASS="COMMAND"
>git init</B
>
        </PRE
>
        Then, import the upstream sources, create the packaging/development
        branch and add the rpm packaging files. You have two choices:
        </P
><P
></P
><OL
TYPE="1"
><LI
><P
>            packaging files and development sources in the same branch
            <PRE
CLASS="SCREEN"
>    $ <B
CLASS="COMMAND"
>git-import-orig-rpm</B
> ../mypackage.tar.gz
    # Optionally (recommended): add gbp.conf
    $ <B
CLASS="COMMAND"
>vim</B
> .gbp.conf &#38;&#38; <B
CLASS="COMMAND"
>git add</B
> .gbp.conf &#38;&#38; <B
CLASS="COMMAND"
>git commit</B
> -m"Add gbp.conf"
    # Add packaging files to source tree under subdir 'packaging'
    $ <B
CLASS="COMMAND"
>mkdir</B
> packaging &#38;&#38; <B
CLASS="COMMAND"
>cd</B
> packaging
    $ <B
CLASS="COMMAND"
>vim</B
> mypackage.spec
    $ <B
CLASS="COMMAND"
>git add</B
> .
    $ <B
CLASS="COMMAND"
>git commit</B
> -m"Add packaging files"
            </PRE
></P
></LI
><LI
><P
>            development sources and packaging files in separate branches
            <PRE
CLASS="SCREEN"
>    $ <B
CLASS="COMMAND"
>git-import-orig-rpm</B
> --no-merge ../mypackage.tar.gz
    # Optionally (recommended): add gbp.conf
    $ <B
CLASS="COMMAND"
>vim</B
> .gbp.conf &#38;&#38; <B
CLASS="COMMAND"
>git add</B
> .gbp.conf &#38;&#38; <B
CLASS="COMMAND"
>git commit</B
> -m"Add gbp.conf"
    # Add packaging files (to root of master branch)
    $ <B
CLASS="COMMAND"
>vim</B
> mypackage.spec
    $ <B
CLASS="COMMAND"
>git add </B
> .
    $ <B
CLASS="COMMAND"
>git commit</B
> -m"Add packaging files"
            </PRE
></P
></LI
></OL
></DIV
><BR
CLEAR="all"><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="GBP.RPM.DEVELOPMENT.CONVERT"
>Converting an existing git repository of a non-native package</A
></H1
><P
>        In this case, you already have a git repository containing the
        upstream source, but it was created neither with <B
CLASS="COMMAND"
>gbp clone</B
> nor
        <B
CLASS="COMMAND"
>gbp import-srpm</B
>.
        You need to have a separate branch for upstream sources.
        If you already have that, you can simply rename that branch to the
        default upstream-branch:
        <PRE
CLASS="SCREEN"
>    $ <B
CLASS="COMMAND"
>git branch</B
> -m my-old-upstream-branch upstream
        </PRE
>
        OR just add the name of your upstream branch to gbp.conf.
        Then, you just create a packaging/development branch(es) with git and
        add packaging files to the packaging branch. If you want to maintain
        sources and packaging in the same branch
        (<A
HREF="gbp.rpm.development.html#GBP.RPM.DEVELOPMENT.MODELS.NONNATIVE1"
>Non-native package, model 1</A
>)
        do something like:
        <PRE
CLASS="SCREEN"
>    $ <B
CLASS="COMMAND"
>git checkout</B
> -b master upstream
    # Optionally (recommended): add gbp.conf
    $ <B
CLASS="COMMAND"
>vim</B
> .gbp.conf &#38;&#38; <B
CLASS="COMMAND"
>git add</B
> .gbp.conf &#38;&#38; <B
CLASS="COMMAND"
>git commit</B
> -m"Add gbp.conf"
    # Add packaging files to source tree, add and commit the packaging files
    # ...
        </PRE
>
        If you want to maintain development sources and packaging in separate
        branches
        (<A
HREF="gbp.rpm.development.html#GBP.RPM.DEVELOPMENT.MODELS.NONNATIVE2"
>Non-native package, model 2</A
>):
        <PRE
CLASS="SCREEN"
>    $ <B
CLASS="COMMAND"
>git checkout</B
> --orphan master
    $ <B
CLASS="COMMAND"
>rm</B
> .git/index
    $ <B
CLASS="COMMAND"
>git commit</B
> --allow-empty -m"Create packaging branch"
    # Optionally (recommended): add gbp.conf
    $ <B
CLASS="COMMAND"
>vim</B
> .gbp.conf &#38;&#38; <B
CLASS="COMMAND"
>git add</B
> .gbp.conf &#38;&#38; <B
CLASS="COMMAND"
>git commit</B
> -m"Add gbp.conf"
    # Next, add and commit the packaging files (.spec etc)
    $ <B
CLASS="COMMAND"
>vim</B
> mypackage.spec &#38;&#38; <B
CLASS="COMMAND"
>git add</B
> mypackage.spec &#38;&#38; <B
CLASS="COMMAND"
>git commit</B
> -m"Add packaging files"
    # Now, you can create the development branch (and import possible patches)
    $ <B
CLASS="COMMAND"
>gbp pq-rpm</B
> import
        </PRE
>
        </P
></DIV
></DIV
><TABLE
CLASS="navigation"
WIDTH="100%"
SUMMARY="Navigation footer"
CELLPADDING="2"
CELLSPACING="2"
><TR
VALIGN="middle"
><TD
ALIGN="left"
><A
ACCESSKEY="p"
HREF="gbp.rpm.intro.html"
><B
>&lt;&lt;&lt;&nbsp;Introduction</B
></A
></TD
><TD
ALIGN="right"
><A
ACCESSKEY="n"
HREF="gbp.rpm.building.html"
><B
>Building RPM packages from the <SPAN
CLASS="PRODUCTNAME"
>Git</SPAN
> repository&nbsp;&gt;&gt;&gt;</B
></A
></TD
></TR
></TABLE
></BODY
></HTML
>